<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minizine Maker</title>
    <link rel="icon" type="image/svg+xml" href="/favicon-zines.svg" />
    <link rel="apple-touch-icon" href="/favicon-zines.svg" />
    <meta name="theme-color" content="#212121" />
    <meta name="description" content="Create beautiful minizines with this easy-to-use layout tool!" />
    
    <!-- Preconnect to external domains for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Font loading with FOUC prevention -->
    <style>
        /* Inline critical font CSS to prevent FOUC */
        @import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Kalam:wght@300;400;700&family=Gaegu:wght@300;400;700&display=block');
        
        /* Font variables with strong fallbacks */
        :root {
            --font-heading: 'Caveat', 'Brush Script MT', 'Lucida Handwriting', cursive;
            --font-body: 'Kalam', 'Comic Sans MS', 'Trebuchet MS', sans-serif;
            --font-handwriting: 'Gaegu', 'Comic Sans MS', 'Courier New', monospace;
        }
        
        /* Immediate font application to prevent flash */
        body {
            font-family: var(--font-body);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            font-display: block;
        }
        
        .font-heading {
            font-family: var(--font-heading);
        }
        
        .font-handwriting {
            font-family: var(--font-handwriting);
        }
        
        /* Hide body until fonts are ready to prevent FOUC */
        body {
            visibility: hidden;
        }
        
        body.fonts-loaded {
            visibility: visible;
        }
    </style>
    
    <!-- StPageFlip library for realistic page turning -->
    <script src="https://unpkg.com/page-flip@2.0.7/dist/js/page-flip.browser.js"></script>
    
    <!-- Font loading detection script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Use FontFace API if available to detect when fonts are loaded
            if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(function() {
                    document.body.classList.add('fonts-loaded');
                });
            } else {
                // Fallback: show content after short delay
                setTimeout(function() {
                    document.body.classList.add('fonts-loaded');
                }, 100);
            }
        });
    </script>
    
    <!-- Analytics - Only load in production -->
    <script>
        // Only load analytics when not on localhost
        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            const script = document.createElement('script');
            script.async = true;
            script.src = '/analytics.js';
            document.head.appendChild(script);
        }
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="./main.tsx"></script>
</body>
</html>
